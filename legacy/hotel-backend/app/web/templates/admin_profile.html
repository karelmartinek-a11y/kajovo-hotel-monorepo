{% extends "base.html" %}

{% set use_sidebar = true %}

{% block sidebar %}
  {% include "admin_sidebar.html" %}
{% endblock %}

{% block title %}KájovoHotel — Admin profil{% endblock %}

{% block head_extra %}{% endblock %}

{% block body_content %}
<div class="page">
  <div class="container admin-shell">
    <main class="admin-main">
      <div class="kj-stack-md">
        <div class="kj-row-split">
          <div class="kj-heading-group">
            <div class="kj-title">Admin profil</div>
            <div class="kj-muted">Změna jediného admin hesla pro web administraci.</div>
          </div>
        </div>

        {% if flash and flash.type == 'success' %}
          <div class="kj-alert-success">{{ flash.message }}</div>
        {% endif %}
        {% if flash and flash.type == 'error' %}
          <div class="kj-alert-error">{{ flash.message }}</div>
        {% endif %}

        <div class="card pad kj-grid-2">
          <div class="kj-stack-sm">
            <div class="kj-note-title">Změnit heslo</div>
            <div class="kj-note-body">Po změně hesla zůstanete přihlášeni. Nové heslo si bezpečně uložte.</div>

            <form class="kj-stack-sm" method="post" action="/admin/profile/password">
              <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />

              <div>
                <div class="label">Současné heslo</div>
                <input class="input" id="current_password" name="current_password" type="password" autocomplete="current-password" required />
              </div>
              <div>
                <div class="label">Nové heslo</div>
                <input class="input" id="new_password" name="new_password" type="password" autocomplete="new-password" minlength="10" required />
                <div class="help">Minimálně 10 znaků.</div>
              </div>
              <div>
                <div class="label">Potvrzení nového hesla</div>
                <input class="input" id="new_password_confirm" name="new_password_confirm" type="password" autocomplete="new-password" minlength="10" required />
              </div>

              <div class="kj-right">
                <button type="submit" class="btn solid">Uložit nové heslo</button>
              </div>
            </form>
          </div>

          <div class="kj-stack-sm">
            <div class="kj-note-title">Bezpečnost</div>
            <ul class="kj-list">
              <li>Web administrace je chráněná jediným heslem (bez účtů).</li>
              <li>Session cookie je <strong>HttpOnly</strong>, <strong>Secure</strong> a <strong>SameSite</strong>.</li>
              <li>Formuláře používají CSRF token.</li>
              <li>Doporučení: používejte správce hesel a pravidelně měňte heslo.</li>
            </ul>
            <div class="card pad">
              <div class="kj-note-title">Poznámka</div>
              <div class="kj-note-body">Portál nyní běží pouze na webu; přístup je řízen standardními účty a hesly.</div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>
{% endblock %}
