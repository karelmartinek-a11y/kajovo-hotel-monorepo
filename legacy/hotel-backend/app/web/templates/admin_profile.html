{% extends "base.html" %}

{% set use_sidebar = true %}

{% block sidebar %}
  {% include "admin_sidebar.html" %}
{% endblock %}

{% block title %}KájovoHotel — Admin profil{% endblock %}

{% block head_extra %}{% endblock %}

{% block body_content %}
<div class="page">
  <div class="container admin-shell">
    {% include "admin_sidebar.html" %}

    <main class="admin-main">
      <div class="stack" style="gap:14px;">
        <div class="row" style="justify-content:space-between;align-items:flex-end;flex-wrap:wrap;">
          <div style="display:flex;flex-direction:column;gap:6px;">
            <div style="font-size:20px;font-weight:850;">Admin profil</div>
            <div style="color:var(--muted);">Změna jediného admin hesla pro web administraci.</div>
          </div>
        </div>

        {% if flash and flash.type == 'success' %}
          <div style="border:1px solid rgba(16,185,129,0.35);background:rgba(16,185,129,0.10);border-radius:12px;padding:12px;color:#047857;">
            {{ flash.message }}
          </div>
        {% endif %}
        {% if flash and flash.type == 'error' %}
          <div style="border:1px solid rgba(239,68,68,0.35);background:rgba(239,68,68,0.10);border-radius:12px;padding:12px;color:#b91c1c;">
            {{ flash.message }}
          </div>
        {% endif %}

        <div class="card pad" style="display:grid;gap:14px;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));">
          <div class="stack" style="gap:10px;">
            <div style="font-weight:800;">Změnit heslo</div>
            <div style="color:var(--muted);font-size:13px;">Po změně hesla zůstanete přihlášeni. Nové heslo si bezpečně uložte.</div>

            <form class="stack" style="gap:10px;" method="post" action="/admin/profile/password">
              <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />

              <div>
                <div class="label">Současné heslo</div>
                <input class="input" id="current_password" name="current_password" type="password" autocomplete="current-password" required />
              </div>
              <div>
                <div class="label">Nové heslo</div>
                <input class="input" id="new_password" name="new_password" type="password" autocomplete="new-password" minlength="10" required />
                <div class="help">Minimálně 10 znaků.</div>
              </div>
              <div>
                <div class="label">Potvrzení nového hesla</div>
                <input class="input" id="new_password_confirm" name="new_password_confirm" type="password" autocomplete="new-password" minlength="10" required />
              </div>

              <div style="display:flex;justify-content:flex-end;">
                <button type="submit" class="btn solid">Uložit nové heslo</button>
              </div>
            </form>
          </div>

          <div class="stack" style="gap:10px;">
            <div style="font-weight:800;">Bezpečnost</div>
            <ul style="margin:0;padding-left:18px;color:var(--muted);font-size:14px;display:grid;gap:6px;list-style:disc;">
              <li>Web administrace je chráněná jediným heslem (bez účtů).</li>
              <li>Session cookie je <strong>HttpOnly</strong>, <strong>Secure</strong> a <strong>SameSite</strong>.</li>
              <li>Formuláře používají CSRF token.</li>
              <li>Doporučení: používejte správce hesel a pravidelně měňte heslo.</li>
            </ul>
            <div class="card pad">
              <div style="font-weight:700;">Poznámka</div>
              <div style="margin-top:6px;color:var(--muted);font-size:13px;">
                Portál nyní běží pouze na webu; přístup je řízen standardními účty a hesly.
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>
{% endblock %}
